<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>前端学习踩坑（6）——自定义组件（续） | 软件工程专业技术分享</title><meta name="keywords" content="前端学习"><meta name="author" content="Little-Bla-ck"><meta name="copyright" content="Little-Bla-ck"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="组件的分割 什么样应该被封装为一个基础组件？什么是业务组件？如何确定组件的props？  基础组件基础组件主要指那些本身不包含任何业务逻辑、可以被轻松复用的组件，例如 picker、timepicker、toast、dialog、tree 等等。 基于 React 或是 Vue 实现一套通用的基础组件库，打包所有基础组件，可以让开发使用非常方便。而对于基础组件的通讯，基本就是往组件传入 prop">
<meta property="og:type" content="article">
<meta property="og:title" content="前端学习踩坑（6）——自定义组件（续）">
<meta property="og:url" content="http://www.littleblack.cc/2022/11/19/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%886%EF%BC%89/index.html">
<meta property="og:site_name" content="软件工程专业技术分享">
<meta property="og:description" content="组件的分割 什么样应该被封装为一个基础组件？什么是业务组件？如何确定组件的props？  基础组件基础组件主要指那些本身不包含任何业务逻辑、可以被轻松复用的组件，例如 picker、timepicker、toast、dialog、tree 等等。 基于 React 或是 Vue 实现一套通用的基础组件库，打包所有基础组件，可以让开发使用非常方便。而对于基础组件的通讯，基本就是往组件传入 prop">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221119142610822.png">
<meta property="article:published_time" content="2022-11-19T05:46:36.000Z">
<meta property="article:modified_time" content="2022-11-19T07:21:22.686Z">
<meta property="article:author" content="Little-Bla-ck">
<meta property="article:tag" content="前端学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221119142610822.png"><link rel="shortcut icon" href="/img/icon.jpg"><link rel="canonical" href="http://www.littleblack.cc/2022/11/19/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%886%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js',
      css: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '前端学习踩坑（6）——自定义组件（续）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-19 15:21:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/icon.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221119142610822.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">软件工程专业技术分享</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">前端学习踩坑（6）——自定义组件（续）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-19T05:46:36.000Z" title="发表于 2022-11-19 13:46:36">2022-11-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-19T07:21:22.686Z" title="更新于 2022-11-19 15:21:22">2022-11-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="前端学习踩坑（6）——自定义组件（续）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="组件的分割"><a href="#组件的分割" class="headerlink" title="组件的分割"></a>组件的分割</h2><blockquote>
<p>什么样应该被封装为一个基础组件？什么是业务组件？如何确定组件的props？</p>
</blockquote>
<h3 id="基础组件"><a href="#基础组件" class="headerlink" title="基础组件"></a>基础组件</h3><p>基础组件主要指那些本身不包含任何业务逻辑、可以被轻松复用的组件，例如 picker、timepicker、toast、dialog、tree 等等。</p>
<p>基于 React 或是 Vue 实现一套通用的基础组件库，打包所有基础组件，可以让开发使用非常方便。而对于基础组件的通讯，基本就是往组件传入 prop 即可，组件内部的状态操作和事件监听在组件内部完成。</p>
<blockquote>
<p>如果实在不知道是不是，可以直接进入Ant Design等业内核心组件库进行查询，他们有的就是基础组件。</p>
</blockquote>
<p>基础组件考虑到复用性，props需要尽量的丰富，且最好支持一定的样式自定义。这个后端会展开说说。</p>
<p><strong>基础组件中不应该出现注释</strong>，且应该放置在项目中的通用目录下，或者使用包管理工具打包管理。</p>
<h3 id="业务组件"><a href="#业务组件" class="headerlink" title="业务组件"></a>业务组件</h3><p>业务组件主要指那些包含业务逻辑，也包括一些与后端接口通讯的逻辑。业务组件会包含若干个基础组件，通常我们会把一些业务逻辑的数据通过 类似 Redux 和 Vuex 等统一的状态管理库管理起来，然后组件内部读取数据和提交对数据修改的动作。</p>
<p>业务组件可放置在对应需求目录下。</p>
<h2 id="组件的设计"><a href="#组件的设计" class="headerlink" title="组件的设计"></a>组件的设计</h2><p>首先应根据需求来考虑组件，比如需求中的功能需求、样式需求、使用平台等。</p>
<p>举个简单的例子，移动端和PC端的组件交互逻辑并不完全一致，就以选择器为例：</p>
<p>下面是微信使用的选择器：</p>
<img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221119142610822.png" alt="image-20221119142610822" style="zoom:50%;" />

<p>下面是Ant Design中的B端选择器：</p>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221119142649852.png" alt="image-20221119142649852"></p>
<p>可以看到，由于屏幕分辨率的大小不同以及交互模式的差异，相同功能的组件在设计上有很大的差距。所以说，在编写 / 设计组件前，做好充分的调研是非常重要的。</p>
<p><strong>设计先行，随后才是实现，不要代码都写完了才发现不符合需求所需，前功尽弃。</strong></p>
<h2 id="组件Props的制定"><a href="#组件Props的制定" class="headerlink" title="组件Props的制定"></a>组件Props的制定</h2><p>以本次我实现的<strong>选择器</strong>组件为例，通过参考AntD中完善的api文档和结合本次需求的需要，我保留了以下props</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">export interface ScrollerSelectOption&lt;K, V&gt; &#123;</span><br><span class="line">  key: K</span><br><span class="line">  value: V</span><br><span class="line">&#125;</span><br><span class="line">export interface ScrollSelectProps&lt;K, V&gt; &#123;</span><br><span class="line">  options: Array&lt;ScrollerSelectOption&lt;K, V&gt;&gt;</span><br><span class="line">  itemsShowCount?: number</span><br><span class="line">  containerHeight?: number</span><br><span class="line">  onChange?: Function</span><br><span class="line">  type?: ScrollSelectType</span><br><span class="line">  value?: V</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里需要提到一个关于命名的最基本的原则：<strong>变量命名应为名词或者形容词 + 名词的短语，方法 / 函数命名应为动词或副词 + 动词的短语。</strong></p>
<blockquote>
<p> 详情可以参考<a href="http://www.littleblack.cc/2022/09/09/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93%EF%BC%881%EF%BC%89/">代码整洁之道（1） | 软件工程专业技术分享 (littleblack.cc)</a></p>
</blockquote>
<p>同时考虑到TypeScript的类型约束，可以灵活的使用泛型来编写组件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export function ScrollableSelect&lt;K extends React.Key, V extends React.ReactElement | string | number&gt; (props: ScrollSelectProps&lt;K, V&gt;)</span><br></pre></td></tr></table></figure>



<blockquote>
<p> 以下内容摘自<a target="_blank" rel="noopener" href="https://ant.design/components/select-cn">选择器 Select - Ant Design</a>：</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">说明</th>
<th align="left">类型</th>
<th align="left">默认值</th>
<th align="left">版本</th>
</tr>
</thead>
<tbody><tr>
<td align="left">allowClear</td>
<td align="left">支持清除</td>
<td align="left">boolean</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">autoClearSearchValue</td>
<td align="left">是否在选中项后清空搜索框，只在 <code>mode</code> 为 <code>multiple</code> 或 <code>tags</code> 时有效</td>
<td align="left">boolean</td>
<td align="left">true</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">autoFocus</td>
<td align="left">默认获取焦点</td>
<td align="left">boolean</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">bordered</td>
<td align="left">是否有边框</td>
<td align="left">boolean</td>
<td align="left">true</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">clearIcon</td>
<td align="left">自定义的多选框清空图标</td>
<td align="left">ReactNode</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">defaultActiveFirstOption</td>
<td align="left">是否默认高亮第一个选项</td>
<td align="left">boolean</td>
<td align="left">true</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">defaultOpen</td>
<td align="left">是否默认展开下拉菜单</td>
<td align="left">boolean</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">defaultValue</td>
<td align="left">指定默认选中的条目</td>
<td align="left">string | string[] number | number[] LabeledValue | LabeledValue[]</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">disabled</td>
<td align="left">是否禁用</td>
<td align="left">boolean</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">popupClassName</td>
<td align="left">下拉菜单的 className 属性</td>
<td align="left">string</td>
<td align="left">-</td>
<td align="left">4.23.0</td>
</tr>
<tr>
<td align="left">dropdownMatchSelectWidth</td>
<td align="left">下拉菜单和选择器同宽。默认将设置 <code>min-width</code>，当值小于选择框宽度时会被忽略。false 时会关闭虚拟滚动</td>
<td align="left">boolean | number</td>
<td align="left">true</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">dropdownRender</td>
<td align="left">自定义下拉框内容</td>
<td align="left">(originNode: ReactNode) =&gt; ReactNode</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">dropdownStyle</td>
<td align="left">下拉菜单的 style 属性</td>
<td align="left">CSSProperties</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">fieldNames</td>
<td align="left">自定义节点 label、value、options 的字段</td>
<td align="left">object</td>
<td align="left">{ label: <code>label</code>, value: <code>value</code>, options: <code>options</code> }</td>
<td align="left">4.17.0</td>
</tr>
<tr>
<td align="left">filterOption</td>
<td align="left">是否根据输入项进行筛选。当其为一个函数时，会接收 <code>inputValue</code> <code>option</code> 两个参数，当 <code>option</code> 符合筛选条件时，应返回 true，反之则返回 false</td>
<td align="left">boolean | function(inputValue, option)</td>
<td align="left">true</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">filterSort</td>
<td align="left">搜索时对筛选结果项的排序函数, 类似<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort">Array.sort</a>里的 compareFunction</td>
<td align="left">(optionA: Option, optionB: Option) =&gt; number</td>
<td align="left">-</td>
<td align="left">4.9.0</td>
</tr>
<tr>
<td align="left">getPopupContainer</td>
<td align="left">菜单渲染父节点。默认渲染到 body 上，如果你遇到菜单滚动定位问题，试试修改为滚动的区域，并相对其定位。<a target="_blank" rel="noopener" href="https://codesandbox.io/s/4j168r7jw0">示例</a></td>
<td align="left">function(triggerNode)</td>
<td align="left">() =&gt; document.body</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">labelInValue</td>
<td align="left">是否把每个选项的 label 包装到 value 中，会把 Select 的 value 类型从 <code>string</code> 变为 { value: string, label: ReactNode } 的格式</td>
<td align="left">boolean</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">listHeight</td>
<td align="left">设置弹窗滚动高度</td>
<td align="left">number</td>
<td align="left">256</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">loading</td>
<td align="left">加载中状态</td>
<td align="left">boolean</td>
<td align="left">false</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">maxTagCount</td>
<td align="left">最多显示多少个 tag，响应式模式会对性能产生损耗</td>
<td align="left">number | <code>responsive</code></td>
<td align="left">-</td>
<td align="left">responsive: 4.10</td>
</tr>
<tr>
<td align="left">maxTagPlaceholder</td>
<td align="left">隐藏 tag 时显示的内容</td>
<td align="left">ReactNode | function(omittedValues)</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">maxTagTextLength</td>
<td align="left">最大显示的 tag 文本长度</td>
<td align="left">number</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">menuItemSelectedIcon</td>
<td align="left">自定义多选时当前选中的条目图标</td>
<td align="left">ReactNode</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">mode</td>
<td align="left">设置 Select 的模式为多选或标签</td>
<td align="left"><code>multiple</code></td>
<td align="left"><code>tags</code></td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">notFoundContent</td>
<td align="left">当下拉列表为空时显示的内容</td>
<td align="left">ReactNode</td>
<td align="left"><code>Not Found</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">open</td>
<td align="left">是否展开下拉菜单</td>
<td align="left">boolean</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">optionFilterProp</td>
<td align="left">搜索时过滤对应的 <code>option</code> 属性，如设置为 <code>children</code> 表示对内嵌内容进行搜索。若通过 <code>options</code> 属性配置选项内容，建议设置 <code>optionFilterProp=&quot;label&quot;</code> 来对内容进行搜索。</td>
<td align="left">string</td>
<td align="left"><code>value</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">optionLabelProp</td>
<td align="left">回填到选择框的 Option 的属性值，默认是 Option 的子元素。比如在子元素需要高亮效果时，此值可以设为 <code>value</code>。<a target="_blank" rel="noopener" href="https://codesandbox.io/s/antd-reproduction-template-tk678">示例</a></td>
<td align="left">string</td>
<td align="left"><code>children</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">options</td>
<td align="left">数据化配置选项内容，相比 jsx 定义会获得更好的渲染性能</td>
<td align="left">{ label, value }[]</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">placeholder</td>
<td align="left">选择框默认文本</td>
<td align="left">string</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">placement</td>
<td align="left">选择框弹出的位置</td>
<td align="left"><code>bottomLeft</code> <code>bottomRight</code> <code>topLeft</code> <code>topRight</code></td>
<td align="left">bottomLeft</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">removeIcon</td>
<td align="left">自定义的多选框清除图标</td>
<td align="left">ReactNode</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">searchValue</td>
<td align="left">控制搜索文本</td>
<td align="left">string</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">showArrow</td>
<td align="left">是否显示下拉小箭头</td>
<td align="left">boolean</td>
<td align="left">单选为 true，多选为 false</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">showSearch</td>
<td align="left">配置是否可搜索</td>
<td align="left">boolean</td>
<td align="left">单选为 false，多选为 true</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">size</td>
<td align="left">选择框大小</td>
<td align="left"><code>large</code></td>
<td align="left"><code>middle</code></td>
<td align="left"><code>small</code></td>
</tr>
<tr>
<td align="left">status</td>
<td align="left">设置校验状态</td>
<td align="left">‘error’ | ‘warning’</td>
<td align="left">-</td>
<td align="left">4.19.0</td>
</tr>
<tr>
<td align="left">suffixIcon</td>
<td align="left">自定义的选择框后缀图标</td>
<td align="left">ReactNode</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">tagRender</td>
<td align="left">自定义 tag 内容 render，仅在 <code>mode</code> 为 <code>multiple</code> 或 <code>tags</code> 时生效</td>
<td align="left">(props) =&gt; ReactNode</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">tokenSeparators</td>
<td align="left">自动分词的分隔符，仅在 <code>mode=&quot;tags&quot;</code> 时生效</td>
<td align="left">string[]</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">value</td>
<td align="left">指定当前选中的条目，多选时为一个数组。（value 数组引用未变化时，Select 不会更新）</td>
<td align="left">string | string[] number | number[] LabeledValue | LabeledValue[]</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">virtual</td>
<td align="left">设置 false 时关闭虚拟滚动</td>
<td align="left">boolean</td>
<td align="left">true</td>
<td align="left">4.1.0</td>
</tr>
<tr>
<td align="left">onBlur</td>
<td align="left">失去焦点时回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onChange</td>
<td align="left">选中 option，或 input 的 value 变化时，调用此函数</td>
<td align="left">function(value, option| Array<Option>)</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onClear</td>
<td align="left">清除内容时回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left">4.6.0</td>
</tr>
<tr>
<td align="left">onDeselect</td>
<td align="left">取消选中时调用，参数为选中项的 value (或 key) 值，仅在 <code>multiple</code> 或 <code>tags</code> 模式下生效</td>
<td align="left">function(string | number | LabeledValue)</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onDropdownVisibleChange</td>
<td align="left">展开下拉菜单的回调</td>
<td align="left">function(open)</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onFocus</td>
<td align="left">获得焦点时回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onInputKeyDown</td>
<td align="left">按键按下时回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onMouseEnter</td>
<td align="left">鼠标移入时回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onMouseLeave</td>
<td align="left">鼠标移出时回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onPopupScroll</td>
<td align="left">下拉列表滚动时的回调</td>
<td align="left">function</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onSearch</td>
<td align="left">文本框值变化时回调</td>
<td align="left">function(value: string)</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">onSelect</td>
<td align="left">被选中时调用，参数为选中项的 value (或 key) 值</td>
<td align="left">function(string | number | LabeledValue, option: Option)</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>考虑到组件使用上不同平台仍有差别，所以需要<strong>辩证的参考api文档。</strong></p>
<h2 id="组件的编写"><a href="#组件的编写" class="headerlink" title="组件的编写"></a>组件的编写</h2><h3 id="ScrollableSelect——滑动选择器"><a href="#ScrollableSelect——滑动选择器" class="headerlink" title="ScrollableSelect——滑动选择器"></a>ScrollableSelect——滑动选择器</h3><p>经过上级的开导和我自己查阅了一些资料，最终确定了如何设计这个ScrollableSelect组件。</p>
<p>核心难点在于：</p>
<ol>
<li>样式如何设计？</li>
<li>如何模拟移动端的交互？（根据触点移动加速度计算列表滑动速度）</li>
<li>如何让它每次自动吸附在停止状态下最近的item？</li>
<li>如何实时跟踪当前选中值？</li>
<li>如何在合适的时机触发onChange？（防抖）</li>
</ol>
<p>其实在写难点的时候，我已经有过排序，1、2、3均使用CSS解决，4、5则是TS编写的部分。</p>
<h4 id="样式如何设计？"><a href="#样式如何设计？" class="headerlink" title="样式如何设计？"></a>样式如何设计？</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  scroll-snap-stop: y mandatory;</span><br><span class="line">  -webkit-<span class="attribute">overflow</span>-scrolling: touch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最核心的部分便在于以下四条css属性。</p>
<p>首先，通过list-style消除list默认样式，同时通过添加overflow：auto自动生成滑动条。</p>
<h4 id="如何让它每次自动吸附在停止状态下最近的item？"><a href="#如何让它每次自动吸附在停止状态下最近的item？" class="headerlink" title="如何让它每次自动吸附在停止状态下最近的item？"></a>如何让它每次自动吸附在停止状态下最近的item？</h4><p>通过添加scroll-snap-stop: y mandatory;属性，控制y方向的自动吸附。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-snap-type">scroll-snap-type - CSS: Cascading Style Sheets | MDN (mozilla.org)</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mandatory</span><br></pre></td></tr></table></figure>

<p>The visual viewport of this scroll container will rest on a snap point if it isn’t currently scrolled. That means it snaps on that point when the scroll action finished, if possible. If content is added, moved, deleted or resized the scroll offset will be adjusted to maintain the resting on that snap point.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proximity</span><br></pre></td></tr></table></figure>

<p>The visual viewport of this scroll container may come to rest on a snap point if it isn’t currently scrolled considering the user agent’s scroll parameters. If content is added, moved, deleted or resized the scroll offset may be adjusted to maintain the resting on that snap point.</p>
<h4 id="如何模拟移动端的交互？"><a href="#如何模拟移动端的交互？" class="headerlink" title="如何模拟移动端的交互？"></a>如何模拟移动端的交互？</h4><p>通过添加-webkit-overflow-scrolling: touch，添加滚动回弹效果。</p>
<blockquote>
<p><font color=red><strong>非标准:</strong> 该特性是非标准的，请尽量不要在生产环境中使用它！</font>目前能力还不足以写出流畅的回弹滚动，不得已使用，在Edge移动端调试工具中运行正常。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto</span><br></pre></td></tr></table></figure>

<p>使用普通滚动，当手指从触摸屏上移开，滚动会立即停止。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch</span><br></pre></td></tr></table></figure>

<p>使用具有回弹效果的滚动，当手指从触摸屏上移开，内容会继续保持一段时间的滚动效果。继续滚动的速度和持续的时间和滚动手势的强烈程度成正比。同时也会创建一个新的堆栈上下文。</p>
<p>同时，关于列表项的样式，这里还有一个重要的属性：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">    scroll-snap-align: start;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>添加该属性使得滑动时以列表项的头部为基准。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">none</span><br></pre></td></tr></table></figure>

<p>The box does not define a snap position in that axis.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start</span><br></pre></td></tr></table></figure>

<p>The start alignment of this box’s scroll snap area, within the scroll container’s snapport is a snap position in this axis.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">end</span><br></pre></td></tr></table></figure>

<p>The end alignment of this box’s scroll snap area, within the scroll container’s snapport is a snap position in this axis.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">center</span><br></pre></td></tr></table></figure>

<p>The center alignment of this box’s scroll snap area, within the scroll container’s snapport is a snap position in this axis.</p>
<h4 id="如何实时跟踪当前选中值？"><a href="#如何实时跟踪当前选中值？" class="headerlink" title="如何实时跟踪当前选中值？"></a>如何实时跟踪当前选中值？</h4><p>这里主要通过使用useScroll hook来实时跟踪滑动的y方向距离，并通过该距离除以每个列表的高度来计算当前对应列表项。</p>
<p>对于不同高度的列表项，通过累加也可以计算出，但本组件未实现该功能。</p>
<p>新建ref并挂载至useScroll hook。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const scrollRef = React.useRef&lt;HTMLUListElement&gt;(null)</span><br><span class="line">const scroll = useScroll(scrollRef)</span><br></pre></td></tr></table></figure>

<p>将ref与滑动列表关联</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul className=&#123;Styles.box&#125; style=&#123;&#123; height: containerHeight &#125;&#125; ref=&#123;scrollRef&#125;&gt;</span><br><span class="line">  &#123;renderTopEmptyOptions()&#125;</span><br><span class="line">  &#123;renderNormalOptions()&#125;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<p>计算得到对应的item</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const calculateIndex = () =&gt; &#123;</span><br><span class="line">  if (scroll?.top !== undefined) &#123;</span><br><span class="line">    const calculatedIndex = Math.floor(scroll.top / itemHeight)</span><br><span class="line">    onChange?.(calculatedIndex)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="如何在合适的时机触发onChange？"><a href="#如何在合适的时机触发onChange？" class="headerlink" title="如何在合适的时机触发onChange？"></a>如何在合适的时机触发onChange？</h4><p>这里就涉及到一个很重要的知识：<strong>防抖</strong></p>
<blockquote>
<p>事件相应函数在一段时间后才执行，如果在这段事件内再次调用，则重新计算执行时间；当预定的时间内没有再次调用该函数，则执行事件相应函数</p>
</blockquote>
<p>看下面我自己不自量力封装的一个useDebouncedEffect源码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">export function useDebouncedEffect (callback: Function, delay: number, deps?: DependencyList) &#123;</span><br><span class="line">  const firstUpdate = React.useRef(true)</span><br><span class="line">  React.useEffect(() =&gt; &#123;</span><br><span class="line">    if (firstUpdate.current) &#123;</span><br><span class="line">      firstUpdate.current = false</span><br><span class="line">      return</span><br><span class="line">    &#125;</span><br><span class="line">    const handler = setTimeout(() =&gt; &#123;</span><br><span class="line">      callback()</span><br><span class="line">    &#125;, delay)</span><br><span class="line"></span><br><span class="line">    return () =&gt; &#123;</span><br><span class="line">      clearTimeout(handler)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  [delay, deps?.values()],</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default useDebouncedEffect</span><br></pre></td></tr></table></figure>

<p>其实核心在于利用了useEffect的一个特性，在下一个useEffect被触发时，会自动清理掉上一个useEffect，这样就保证了同时只存在一个计时器。</p>
<p>但是秉着不重复造轮子的原则，还是使用了aHooks中的useDebouncedEffect。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">useDebounceEffect(calculateIndex, [scroll], &#123; wait: 500 &#125;)</span><br><span class="line">const calculateIndex = () =&gt; &#123;</span><br><span class="line">    if (scroll?.top !== undefined) &#123;</span><br><span class="line">        const calculatedIndex = Math.floor(scroll.top / itemHeight)</span><br><span class="line">        onChange?.(calculatedIndex)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此，核心难题全部解决，剩下的就是一些基本的功能实现。</p>
<p>比如通过value设置初始值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">React.useEffect(() =&gt; &#123;</span><br><span class="line">  if (scrollRef?.current) &#123;</span><br><span class="line">    scrollRef.current.scroll(0, findIndexByValue() * itemHeight)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [])</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://www.littleblack.cc">Little-Bla-ck</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.littleblack.cc/2022/11/19/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%886%EF%BC%89/">http://www.littleblack.cc/2022/11/19/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%886%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.littleblack.cc" target="_blank">软件工程专业技术分享</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/">前端学习</a></div><div class="post_share"><div class="social-share" data-image="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221119142610822.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/ShareJS/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/ShareJS/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/11/20/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%887%EF%BC%89/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">前端学习踩坑（7）——大佬源码学习笔记</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/14/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-operating-system-4/"><img class="next-cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20221121101447355.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">操作系统-operating-system-4</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/16/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%884%EF%BC%89/" title="前端学习踩坑（4）"><img class="cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220816193645532.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-16</div><div class="title">前端学习踩坑（4）</div></div></a></div><div><a href="/2022/07/17/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%881%EF%BC%89/" title="前端学习踩坑（1）"><img class="cover" src="http://image.littleblack.cc/blogimages/QQ%E5%9B%BE%E7%89%8720220717175253.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-17</div><div class="title">前端学习踩坑（1）</div></div></a></div><div><a href="/2022/07/20/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%882%EF%BC%89/" title="前端学习踩坑（2）"><img class="cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220726224722603.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-20</div><div class="title">前端学习踩坑（2）</div></div></a></div><div><a href="/2022/08/27/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%885%EF%BC%89/" title="前端学习踩坑（5）"><img class="cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220827120842096.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-27</div><div class="title">前端学习踩坑（5）</div></div></a></div><div><a href="/2022/08/15/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%883%EF%BC%89/" title="前端学习踩坑（3）"><img class="cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220815004236052.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-15</div><div class="title">前端学习踩坑（3）</div></div></a></div><div><a href="/2022/11/20/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B8%A9%E5%9D%91%EF%BC%887%EF%BC%89/" title="前端学习踩坑（7）——大佬源码学习笔记"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-20</div><div class="title">前端学习踩坑（7）——大佬源码学习笔记</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/icon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Little-Bla-ck</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Little-Bla-ck/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Little-bla-ck" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1173198173@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">南京大学软件工程专业大三在读</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E5%88%86%E5%89%B2"><span class="toc-number">1.</span> <span class="toc-text">组件的分割</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">基础组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">业务组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text">组件的设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6Props%E7%9A%84%E5%88%B6%E5%AE%9A"><span class="toc-number">3.</span> <span class="toc-text">组件Props的制定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">4.</span> <span class="toc-text">组件的编写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ScrollableSelect%E2%80%94%E2%80%94%E6%BB%91%E5%8A%A8%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">ScrollableSelect——滑动选择器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%EF%BC%9F"><span class="toc-number">4.1.1.</span> <span class="toc-text">样式如何设计？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%A9%E5%AE%83%E6%AF%8F%E6%AC%A1%E8%87%AA%E5%8A%A8%E5%90%B8%E9%99%84%E5%9C%A8%E5%81%9C%E6%AD%A2%E7%8A%B6%E6%80%81%E4%B8%8B%E6%9C%80%E8%BF%91%E7%9A%84item%EF%BC%9F"><span class="toc-number">4.1.2.</span> <span class="toc-text">如何让它每次自动吸附在停止状态下最近的item？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%A8%A1%E6%8B%9F%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%9A%84%E4%BA%A4%E4%BA%92%EF%BC%9F"><span class="toc-number">4.1.3.</span> <span class="toc-text">如何模拟移动端的交互？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E6%97%B6%E8%B7%9F%E8%B8%AA%E5%BD%93%E5%89%8D%E9%80%89%E4%B8%AD%E5%80%BC%EF%BC%9F"><span class="toc-number">4.1.4.</span> <span class="toc-text">如何实时跟踪当前选中值？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%9C%A8%E5%90%88%E9%80%82%E7%9A%84%E6%97%B6%E6%9C%BA%E8%A7%A6%E5%8F%91onChange%EF%BC%9F"><span class="toc-number">4.1.5.</span> <span class="toc-text">如何在合适的时机触发onChange？</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/11/%E9%9D%A2%E7%BB%8F/%E9%9D%A2%E7%BB%8F%EF%BC%883%EF%BC%89%E2%80%94%E2%80%94%E9%98%BF%E9%87%8C%E9%92%89%E9%92%89%E4%B8%80%E9%9D%A2/" title="面经（3）————阿里钉钉一面"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面经（3）————阿里钉钉一面"/></a><div class="content"><a class="title" href="/2023/03/11/%E9%9D%A2%E7%BB%8F/%E9%9D%A2%E7%BB%8F%EF%BC%883%EF%BC%89%E2%80%94%E2%80%94%E9%98%BF%E9%87%8C%E9%92%89%E9%92%89%E4%B8%80%E9%9D%A2/" title="面经（3）————阿里钉钉一面">面经（3）————阿里钉钉一面</a><time datetime="2023-03-11T12:56:31.000Z" title="发表于 2023-03-11 20:56:31">2023-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/17/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E9%9C%80%E6%B1%82/" title="需求与商业模式——需求工程"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——需求工程"/></a><div class="content"><a class="title" href="/2023/02/17/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E9%9C%80%E6%B1%82/" title="需求与商业模式——需求工程">需求与商业模式——需求工程</a><time datetime="2023-02-17T09:20:17.244Z" title="发表于 2023-02-17 17:20:17">2023-02-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E7%94%BB%E5%B8%83/" title="需求与商业模式——商业模式画布"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——商业模式画布"/></a><div class="content"><a class="title" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E7%94%BB%E5%B8%83/" title="需求与商业模式——商业模式画布">需求与商业模式——商业模式画布</a><time datetime="2023-02-16T15:09:37.674Z" title="发表于 2023-02-16 23:09:37">2023-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E8%AF%84%E4%BC%B0%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——商业模式评估"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——商业模式评估"/></a><div class="content"><a class="title" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E8%AF%84%E4%BC%B0%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——商业模式评估">需求与商业模式——商业模式评估</a><time datetime="2023-02-16T15:09:37.672Z" title="发表于 2023-02-16 23:09:37">2023-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%85%B8%E5%9E%8B%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——典型商业模式"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——典型商业模式"/></a><div class="content"><a class="title" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%85%B8%E5%9E%8B%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——典型商业模式">需求与商业模式——典型商业模式</a><time datetime="2023-02-16T15:09:37.669Z" title="发表于 2023-02-16 23:09:37">2023-02-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>宁ICP备2022000187号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/pluginsSrc/instant.page/instantpage.js" type="module"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = '/pluginsSrc/mathjax/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="/pluginsSrc/katex/dist/katex.min.css"><script src="/pluginsSrc/katex/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="/pluginsSrc/katex/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('/pluginsSrc/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="/pluginsSrc/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>