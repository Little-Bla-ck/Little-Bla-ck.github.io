<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>设计模式-行为型模式 | 软件工程专业技术分享</title><meta name="keywords" content="设计模式"><meta name="author" content="Little-Bla-ck"><meta name="copyright" content="Little-Bla-ck"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="声明：文章内容绝大多数来自于南京大学 计算机科学与技术系 面向对象设计方法 课程课件  设计模式-行为型模式 行为型模式(Behavioral Pattern) 关注系统中对象之间的交互，研究系统在运行时对象之间的相互通信与协作，进一步明确对象的职责 行为型模式：不仅仅关注类和对象本身，还重点关注它们之间的相互作用和职责划分   类行为型模式 使用继承关系在几个类之间分配行为，主要通过多态等方式">
<meta property="og:type" content="article">
<meta property="og:title" content="设计模式-行为型模式">
<meta property="og:url" content="http://www.littleblack.cc/2022/06/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/index.html">
<meta property="og:site_name" content="软件工程专业技术分享">
<meta property="og:description" content="声明：文章内容绝大多数来自于南京大学 计算机科学与技术系 面向对象设计方法 课程课件  设计模式-行为型模式 行为型模式(Behavioral Pattern) 关注系统中对象之间的交互，研究系统在运行时对象之间的相互通信与协作，进一步明确对象的职责 行为型模式：不仅仅关注类和对象本身，还重点关注它们之间的相互作用和职责划分   类行为型模式 使用继承关系在几个类之间分配行为，主要通过多态等方式">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612114952212.png">
<meta property="article:published_time" content="2022-06-13T09:18:26.000Z">
<meta property="article:modified_time" content="2022-11-21T03:47:12.839Z">
<meta property="article:author" content="Little-Bla-ck">
<meta property="article:tag" content="设计模式">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612114952212.png"><link rel="shortcut icon" href="/img/icon.jpg"><link rel="canonical" href="http://www.littleblack.cc/2022/06/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js',
      css: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '设计模式-行为型模式',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-21 11:47:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/icon.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612114952212.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">软件工程专业技术分享</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">设计模式-行为型模式</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-13T09:18:26.000Z" title="发表于 2022-06-13 17:18:26">2022-06-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-21T03:47:12.839Z" title="更新于 2022-11-21 11:47:12">2022-11-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">11.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="设计模式-行为型模式"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>声明：文章内容绝大多数来自于南京大学 计算机科学与技术系 面向对象设计方法 课程课件</p>
</blockquote>
<h1 id="设计模式-行为型模式"><a href="#设计模式-行为型模式" class="headerlink" title="设计模式-行为型模式"></a>设计模式-行为型模式</h1><ul>
<li>行为型模式(Behavioral Pattern) <strong>关注系统中对象之间的交互</strong>，研究系统在运行时<strong>对象之间的相互通信与协作</strong>，进一步<strong>明确对象的职责</strong></li>
<li>行为型模式：<strong>不仅仅关注类和对象本身，还重点关注它们之间的相互作用和职责划分</strong></li>
</ul>
<ul>
<li>类行为型模式<ul>
<li>使用<strong>继承关系</strong>在几个类之间分配行为，主要<strong>通过多态等方式来分配父类与子类的职责</strong></li>
</ul>
</li>
<li>对象行为型模式<ul>
<li>使用对象的<strong>关联关系</strong>来分配行为，主要<strong>通过对象关联等方式来分配两个或多个类的职责</strong></li>
</ul>
</li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612114952212.png" alt="image-20220612114952212"></p>
<h2 id="Chain-of-Responsibility-Pattern-职责链模式"><a href="#Chain-of-Responsibility-Pattern-职责链模式" class="headerlink" title="Chain of Responsibility Pattern 职责链模式"></a>Chain of Responsibility Pattern 职责链模式</h2><p>职责链模式：<strong>避免</strong>将一个请求的发送者与接受者<strong>耦合</strong>在一起，<strong>让多个对象都有机会处理请求</strong>。将处理请求的对象连接成一条链，并且沿着这条链传递请求，直到有一个对象能够处理它为止。</p>
<ul>
<li>职责链模式的定义<ul>
<li>将<strong>请求的处理者组织成一条链</strong>，并<strong>让请求沿着链传递</strong>，由链上的处理者对请求进行相应的处理</li>
<li><strong>客户端无须关心请求的处理细节以及请求的传递</strong>，只需将<strong>请求发送到链上，将请求的发送者和请求的处理者解耦</strong></li>
</ul>
</li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612145032840.png" alt="image-20220612145032840"></p>
<blockquote>
<p>Handler：抽象处理者<br>ConcreteHandler：具体处理者</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChainOfResponsibilityPattern</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//组装责任链</span></span><br><span class="line">        Handler handler1 = <span class="keyword">new</span> ConcreteHandler1();</span><br><span class="line">        Handler handler2 = <span class="keyword">new</span> ConcreteHandler2();</span><br><span class="line">        handler1.setNext(handler2);</span><br><span class="line">        <span class="comment">//提交请求</span></span><br><span class="line">        handler1.handleRequest(<span class="string">&quot;two&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//抽象处理者角色</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Handler next;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNext</span><span class="params">(Handler next)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Handler <span class="title">getNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//处理请求的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String request)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体处理者角色1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteHandler1</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.equals(<span class="string">&quot;one&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;具体处理者1负责处理该请求！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getNext() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                getNext().handleRequest(request);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;没有人处理该请求！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体处理者角色2</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteHandler2</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.equals(<span class="string">&quot;two&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;具体处理者2负责处理该请求！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getNext() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                getNext().handleRequest(request);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;没有人处理该请求！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>纯的职责链模式</p>
<ul>
<li>一个具体处理者对象只能在两个行为中选择一个：<strong>要么承担全部责任，要么将责任推给下家</strong></li>
<li><strong>不允许出现某一个具体处理者对象在承担了一部分或全部责任后又将责任向下传递</strong>的情况</li>
<li><strong>一个请求必须被某一个处理者对象所接收，不能出现某个请求未被任何一个处理者对象处理</strong>的情况</li>
</ul>
</li>
<li><p>不纯的职责链模式</p>
<ul>
<li><strong>允许某个请求被一个具体处理者部分处理后向下传递，或者一个具体处理者处理完某请求后其后继处理者可以继续处理该请求</strong></li>
<li>一个请求<strong>可以最终不被任何处理者对象所接收并处理</strong></li>
</ul>
</li>
</ul>
<h3 id="模式优点"><a href="#模式优点" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li>使得一个对象无须知道是其他哪一个对象处理其请求，<strong>降低了系统的耦合度</strong></li>
<li><strong>可简化对象之间的相互连接</strong></li>
<li>给对象<strong>职责的分配带来更多的灵活性</strong></li>
<li><strong>增加一个新的具体请求处理者时无须修改原有系统的代码</strong>，只需要在客户端重新建链即可</li>
</ul>
<h3 id="模式缺点"><a href="#模式缺点" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li><strong>不能保证请求一定会被处理</strong></li>
<li>对于比较长的职责链，<strong>系统性能将受到一定影响，在进行代码调试时不太方便</strong></li>
<li>如果建链不当，可能会造成<strong>循环调用，将导致系统陷入死循环</strong></li>
</ul>
<h3 id="模式适用环境"><a href="#模式适用环境" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li><strong>有多个对象可以处理同一个请求</strong>，具体哪个对象处理该<strong>请求待运行时刻再确定</strong></li>
<li>在不明确指定接收者的情况下，<strong>向多个对象中的一个提交一个请求</strong></li>
<li>可<strong>动态指定一组对象处理请求</strong></li>
</ul>
<h2 id="Command-Pattern-命令模式"><a href="#Command-Pattern-命令模式" class="headerlink" title="Command Pattern 命令模式"></a>Command Pattern 命令模式</h2><ul>
<li>软件开发<ul>
<li>按钮 ——请求发送者</li>
<li>时间处理类——请求的最终接受者和处理者</li>
<li>发送者与接受者之间引入了新的<strong>命令对象</strong>（类似电线），将发送者的请求封装在命令对象中，再通过命令对象来调用接收者的方法。</li>
<li>相同的按钮可以对应不同的事件处理类</li>
</ul>
</li>
<li>动机<ul>
<li>将请求发送者和接收者完全解耦</li>
<li>发送者与接收者之间没有直接引用关系</li>
<li>发送请求的对象只需要知道如何发送请求，而不必知道如何完成请求</li>
</ul>
</li>
</ul>
<p><strong>命令模式：将一个请求封装为一个对象</strong>，从而可以用不同的请求<strong>对客户进行参数化</strong>，<strong>对请求排队</strong>或者<strong>记录请求日志</strong>，以及<strong>支持可撤销的操作。</strong></p>
<ul>
<li>别名为<strong>动作(Action)模式或事务(Transaction)模式</strong></li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612165502062.png" alt="image-20220612165502062"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receiver</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;Action has been taken.&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Command command;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Invoker</span><span class="params">(Command command)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.command = command;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">		command.execute();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Receiver receiver;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteCommand</span><span class="params">(Receiver receiver)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		receiver.action();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Receiver receiver = <span class="keyword">new</span> Receiver();</span><br><span class="line">		Command cmd = <span class="keyword">new</span> ConcreteCommand(receiver);</span><br><span class="line">		Invoker invoker = <span class="keyword">new</span> Invoker(cmd);</span><br><span class="line">		invoker.action();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>Command 抽象命令类</li>
<li>ConcreteCommand 具体命令类</li>
<li>Invoker 调用类</li>
<li>Receiver 接收者</li>
</ul>
</blockquote>
<ul>
<li>命令模式的实现<ul>
<li>命令模式的本质是<strong>对请求进行封装</strong></li>
<li><strong>一个请求对应于一个命令</strong>，将发出命令的责任和执行命令的责任分开</li>
<li>命令模式<strong>允许请求的一方和接收的一方独立开来</strong>，使得<strong>请求的一方不必知道接收请求的一方的接口</strong>，更不必知道请求如何被接收、操作是否被执行、何时被执行，以及是怎么被执行的</li>
</ul>
</li>
</ul>
<h3 id="实现命令队列"><a href="#实现命令队列" class="headerlink" title="实现命令队列"></a>实现命令队列</h3><blockquote>
<p>以下代码实现来自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/JsonShare/p/7206665.html">设计模式解密（11）- 命令模式 - 扩展篇（请求日志） - Json_wangqiang - 博客园 (cnblogs.com)</a></p>
</blockquote>
<ul>
<li>当一个请求发送者发送一个请求时，有不止一个请求接收者产生响应，这些请求接收者将逐个执行业务方法，完成对请求的处理</li>
<li>增加一个CommandQueue类，由该类负责存储多个命令对象，而不同的命令对象可以对应不同的请求接收者</li>
<li>批处理</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandQueue</span> </span>&#123;    </span><br><span class="line">    <span class="comment">//定义一个ArrayList来存储命令队列    </span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Command&gt; commands = <span class="keyword">new</span> ArrayList&lt;Command&gt;();    </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCommand</span><span class="params">(Command command)</span> </span>&#123;    </span><br><span class="line">        commands.add(command);    </span><br><span class="line">    &#125;    </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeCommand</span><span class="params">(Command command)</span> </span>&#123;    </span><br><span class="line">        commands.remove(command);    </span><br><span class="line">    &#125;    </span><br><span class="line">        </span><br><span class="line">    <span class="comment">//循环调用每一个命令对象的execute()方法    </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;    </span><br><span class="line">        <span class="keyword">for</span> (Object command : commands) &#123;    </span><br><span class="line">            ((Command)command).execute();    </span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;    </span><br><span class="line">    <span class="keyword">private</span> CommandQueue commandQueue; <span class="comment">//维持一个CommandQueue对象的引用    </span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">//构造注入    </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Invoker</span><span class="params">(CommandQueue commandQueue)</span> </span>&#123;    </span><br><span class="line">        <span class="keyword">this</span>. commandQueue = commandQueue;    </span><br><span class="line">    &#125;    </span><br><span class="line">        </span><br><span class="line">    <span class="comment">//设值注入    </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommandQueue</span><span class="params">(CommandQueue commandQueue)</span> </span>&#123;    </span><br><span class="line">        <span class="keyword">this</span>.commandQueue = commandQueue;    </span><br><span class="line">    &#125;    </span><br><span class="line">        </span><br><span class="line">    <span class="comment">//调用CommandQueue类的execute()方法    </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;    </span><br><span class="line">        commandQueue.execute();    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="记录请求日志"><a href="#记录请求日志" class="headerlink" title="记录请求日志"></a>记录请求日志</h3><blockquote>
<p>以下代码实现来自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/JsonShare/p/7206665.html">设计模式解密（11）- 命令模式 - 扩展篇（请求日志） - Json_wangqiang - 博客园 (cnblogs.com)</a></p>
</blockquote>
<ul>
<li><strong>将请求的历史记录保存下来</strong>，通常**以日志文件(LogFile)**的形式永久存储在计算机中<ul>
<li>为系统提供一种<strong>恢复机制</strong></li>
<li>可以用于实现批处理</li>
<li>防止因为断点或者系统重启等原因造成请求丢失，而且可以避免重新发送全部请求时造成某些命令的重复执行</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 抽象命令类，由于需要将命令对象写入文件，因此它实现了Serializable接口  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Command</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> String name; <span class="comment">//命令名称 </span></span><br><span class="line">    <span class="keyword">protected</span> String args; <span class="comment">//命令参数  </span></span><br><span class="line">    <span class="keyword">protected</span> Operator operator; <span class="comment">//接收者对象</span></span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Command</span><span class="params">(String name)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.name = name;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOperator</span><span class="params">(Operator operator)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.operator = operator;  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//声明两个抽象的执行方法execute()  </span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String args)</span></span>;  </span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求接收者 -- 由于Operator类的对象是Command的成员对象，它也将随Command对象一起写入文件，因此Operator也需要实现Serializable接口  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Operator</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">&quot;新增数据：&quot;</span> + args);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">&quot;修改数据：&quot;</span> + args);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        System.out.println(<span class="string">&quot;删除数据：&quot;</span> + args);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体命令角色类 -- 插入命令</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InsertCommand</span> <span class="keyword">extends</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InsertCommand</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.args = args;  </span><br><span class="line">        operator.insert(args);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        operator.insert(<span class="keyword">this</span>.args);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体命令角色类 -- 修改命令</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateCommand</span> <span class="keyword">extends</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpdateCommand</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.args = args;  </span><br><span class="line">        operator.update(args);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        operator.update(<span class="keyword">this</span>.args);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体命令角色类 -- 删除命令</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeleteCommand</span> <span class="keyword">extends</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DeleteCommand</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.args = args;  </span><br><span class="line">        operator.delete(args);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        operator.delete(<span class="keyword">this</span>.args);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求发送者</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SqlExecuteTool</span> </span>&#123;</span><br><span class="line">     <span class="comment">//定义一个集合来存储每一次操作时的命令对象  </span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Command&gt; commands = <span class="keyword">new</span> ArrayList&lt;Command&gt;();  </span><br><span class="line">    <span class="keyword">private</span> Command command;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//注入具体命令对象  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command command)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.command = command;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">//执行配置文件修改命令，同时将命令对象添加到命令集合中  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String args)</span> </span>&#123;  </span><br><span class="line">        command.execute(args);  </span><br><span class="line">        commands.add(command);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">//记录请求日志，生成日志文件，将命令集合写入日志文件  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        FileUtil.writeCommands(commands);  </span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    <span class="comment">//从日志文件中提取命令集合，并循环调用每一个命令对象的execute()方法来实现配置文件的重新设置  </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recover</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        ArrayList list = FileUtil.readCommands();  </span><br><span class="line">        <span class="keyword">for</span> (Object obj : list) &#123;  </span><br><span class="line">            ((Command)obj).execute();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="实现恢复操作"><a href="#实现恢复操作" class="headerlink" title="实现恢复操作"></a>实现恢复操作</h3><p>可以通过对命令类进行修改使得系统支持<strong>撤销(Undo)操作和恢复(Redo)操作</strong></p>
<p>核心思想：使用逆向操作实现（通过增加execute对应的undo方法）</p>
<p>​                    或者使用备忘录模式直接恢复</p>
<blockquote>
<p>以下示例为逆向操作实现范例</p>
</blockquote>
<blockquote>
<p>以下实现代码来自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/JsonShare/p/7206513.html">设计模式解密（11）- 命令模式 - 扩展篇（撤销命令） - Json_wangqiang - 博客园 (cnblogs.com)</a></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 包含撤销命令的接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="comment">//执行方法</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//撤销方法</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体命令 -- 创建目录</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateDirCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String dirName;</span><br><span class="line">    MakeDir makeDir;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CreateDirCommand</span><span class="params">(MakeDir makeDir,String dirName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.makeDir = makeDir;</span><br><span class="line">        <span class="keyword">this</span>.dirName = dirName;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        makeDir.createDir(dirName);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        makeDir.deleteDir(dirName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 命令接受者</span></span><br><span class="line"><span class="comment"> * 包含两个命令：创建目录、删除目录</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MakeDir</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建目录</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createDir</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        File dir = <span class="keyword">new</span> File(name);</span><br><span class="line">        <span class="keyword">if</span> (dir.exists()) &#123;  </span><br><span class="line">            System.out.println(<span class="string">&quot;创建目录 &quot;</span> + name + <span class="string">&quot; 失败，目标目录已经存在&quot;</span>);  </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//创建目录  </span></span><br><span class="line">            <span class="keyword">if</span> (dir.mkdirs()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;创建目录 &quot;</span> + name + <span class="string">&quot; 成功&quot;</span>);  </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">                System.out.println(<span class="string">&quot;创建目录 &quot;</span> + name + <span class="string">&quot; 失败&quot;</span>);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除目录</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteDir</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        File dir = <span class="keyword">new</span> File(name);</span><br><span class="line">        <span class="keyword">if</span>(dir.exists()) &#123;  </span><br><span class="line">            <span class="keyword">if</span>(dir.delete())&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;删除目录 &quot;</span> + name + <span class="string">&quot; 成功&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;删除目录 &quot;</span> + name + <span class="string">&quot; 失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;删除目录 &quot;</span> + name + <span class="string">&quot; 失败，目标目录不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求者</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Json</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestMakeDir</span> </span>&#123;</span><br><span class="line">    Command createCommand;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCreateCommand</span><span class="params">(Command command)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.createCommand = command;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">executeCreateCommand</span><span class="params">()</span></span>&#123;</span><br><span class="line">        createCommand.execute();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undoCreateCommand</span><span class="params">()</span></span>&#123;</span><br><span class="line">        createCommand.undo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="模式优点-1"><a href="#模式优点-1" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li><strong>降低系统的耦合度</strong></li>
<li>新的命令可以很容易地加入到系统中，<strong>符合开闭原则</strong></li>
<li>可以比较容易地设计一个<strong>命令队列或宏命令（组合命令）</strong></li>
<li>为请求的**撤销(Undo)和恢复(Redo)**操作提供了一种设计和实现方案</li>
</ul>
<h3 id="模式缺点-1"><a href="#模式缺点-1" class="headerlink" title="模式缺点"></a>模式缺点</h3><p>使用命令模式<strong>可能会导致某些系统有过多的具体命令类</strong>（针对每一个对请求接收者的调用操作都需要设计一个具体命令类）</p>
<h3 id="模式适用环境-1"><a href="#模式适用环境-1" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>系统需要<strong>将请求调用者和请求接收者解耦</strong>，使得调用者和接收者不直接交互</li>
<li>系统需要<strong>在不同的时间指定请求、将请求排队和执行请求</strong></li>
<li>系统需要<strong>支持命令的撤销(Undo)操作和恢复(Redo)操作</strong></li>
<li>系统需要<strong>将一组操作组合在一起形成宏命令</strong></li>
</ul>
<h2 id="Interpreter-Pattern-解释器模式"><a href="#Interpreter-Pattern-解释器模式" class="headerlink" title="Interpreter Pattern 解释器模式"></a>Interpreter Pattern 解释器模式</h2><p>解释器模式：给定一个语言，<strong>定义它的文法的一种表示</strong>，并定义一个解释器，这个<strong>解释器使用该表示来解释语言中的句子。</strong></p>
<ul>
<li>解释器模式的定义<ul>
<li>在解释器模式的定义中所指的“语言”是<strong>使用规定格式和语法的代码</strong></li>
<li>是一种<strong>使用频率相对较低但学习难度相对较大</strong>的设计模式，用于<strong>描述如何使用面向对象语言构成一个简单的语言解释器</strong></li>
<li>能够<strong>加深对面向对象思想的理解</strong>，并且<strong>理解编程语言中文法规则的解释过程</strong></li>
</ul>
</li>
</ul>
<ul>
<li>解释器模式的结构</li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613202812736.png" alt="image-20220613202812736"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">interpret</span><span class="params">(Context ctx)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TerminalExpression</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">interpret</span><span class="params">(Context ctx)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//终结符表达式的解释操作</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonterminalExpression</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NonterminalExpression</span><span class="params">(AbstractExpression</span></span></span><br><span class="line"><span class="params"><span class="function">                                 left,AbstractExpression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.left=left;</span><br><span class="line">        <span class="keyword">this</span>.right=right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">interpret</span><span class="params">(Context ctx)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//递归调用每一个组成部分的interpret()方法</span></span><br><span class="line">        <span class="comment">//在递归调用时指定组成部分的连接方式，即非终结符的功能</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;String,</span><br><span class="line">    String&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">assign</span><span class="params">(String key, String value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//往环境类中设值</span></span><br><span class="line">        map.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">lookup</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取存储在环境类中的值</span></span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="模式优点-2"><a href="#模式优点-2" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li><strong>易于改变和扩展文法</strong>：由于在解释器模式中使用类表示语言的文法规则，因此可以通过继承等机制来改变或扩展文法。</li>
<li>可以<strong>方便地实现一个简单的语言</strong>：每一条文法规则都可以表示为一个类。</li>
<li><strong>实现文法较为容易</strong>（有自动生成工具）。</li>
<li><strong>增加</strong>新的<strong>解释表达式较为方便</strong>，符合开闭原则。</li>
</ul>
<h3 id="模式缺点-2"><a href="#模式缺点-2" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li>对于复杂文法难以维护：<strong>在解释器中每一条规则至少需要定义一个类</strong>，因此，一个语言如果包含太多文法规则，类的个数会急剧增加，导致系统难以管理和维护，此时可以考虑语法分析程序等方式来取代解释器模式。</li>
<li>执行效率较低：由于在解释器模式中使用了大量的循环和递归调用，因此在解释较为复杂的句子时其速度很慢，而且代码的调用过程也比较麻烦。</li>
</ul>
<h3 id="模式适用环境-2"><a href="#模式适用环境-2" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>可以将一个需要解释执行的语言中的句子表示为一棵<strong>抽象语法树</strong></li>
<li>一些重复出现的问题<strong>可以用一种简单的语言来进行表达</strong></li>
<li>一个语言的文法<strong>较为简单</strong></li>
<li><strong>执行效率不是关键问题</strong></li>
</ul>
<h2 id="Iterator-Pattern-迭代器模式"><a href="#Iterator-Pattern-迭代器模式" class="headerlink" title="Iterator Pattern 迭代器模式"></a><font color = red>Iterator Pattern 迭代器模式</font></h2><p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613203517012.png" alt="image-20220613203517012"></p>
<ul>
<li><p>分析</p>
<ul>
<li><p><strong>电视机</strong>&lt;-&gt;存储电视频道的集合&lt;-&gt;<strong>聚合类(Aggregate Classes)</strong></p>
</li>
<li><p><strong>电视机遥控器</strong>&lt;-&gt;操作电视频道&lt;-&gt;<strong>迭代器(Iterator)</strong></p>
</li>
<li><p><strong>访问一个聚合对象中的元素但又不需要暴露它的内部结构</strong></p>
</li>
<li><p>聚合对象的两个职责：</p>
<ul>
<li><strong>存储数据，聚合对象的基本职责</strong></li>
<li><strong>遍历数据，既是可变化的，又是可分离的</strong></li>
</ul>
</li>
<li><p><strong>将遍历数据的行为从聚合对象中分离出来</strong>，封装在迭代器对象中</p>
</li>
<li><p>由迭代器来提供遍历聚合对象内部数据的行为，<strong>简化聚合对象的设计，更符合单一职责原则</strong></p>
</li>
</ul>
</li>
</ul>
<p>迭代器模式：提供一种方法<strong>顺序访问一个聚合对象中各个元素，且不用暴露该对象的内部表示。</strong></p>
<ul>
<li>又名<strong>游标(Cursor)模式</strong></li>
<li>通过引入迭代器，<strong>客户端无须了解聚合对象的内部结构即可实现对聚合对象中成员的遍历，还可以根据需要很方便地增加新的遍历方式</strong></li>
</ul>
<ul>
<li>迭代器模式的结构</li>
</ul>
<img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613204418537.png" alt="image-20220613204418537" style="zoom:67%;" />

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">first</span><span class="params">()</span></span>; <span class="comment">//将游标指向第一个元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">next</span><span class="params">()</span></span>; <span class="comment">//将游标指向下一个元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>; <span class="comment">//判断是否存在下一个元素</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">currentItem</span><span class="params">()</span></span>; <span class="comment">//获取游标指向的当前元素</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ConcreteAggregate objects; <span class="comment">//维持一个对具体聚合对象的引</span></span><br><span class="line">    用，以便于访问存储在聚合对象中的数据</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> cursor; <span class="comment">//定义一个游标，用于记录当前访问位置</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteIterator</span><span class="params">(ConcreteAggregate objects)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.objects=objects;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">first</span><span class="params">()</span> </span>&#123; ...... &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">next</span><span class="params">()</span> </span>&#123; ...... &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123; ...... &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">currentItem</span><span class="params">()</span> </span>&#123; ...... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Aggregate</span> </span>&#123;</span><br><span class="line">    <span class="function">Iterator <span class="title">createIterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteAggregate</span> <span class="keyword">implements</span> <span class="title">Aggregate</span> </span>&#123;</span><br><span class="line">    ......</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Iterator <span class="title">createIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteIterator(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>结果及分析<ul>
<li>如果需要<strong>增加一个新的具体聚合类</strong>，只需增加一个新的聚合子类和一个新的具体迭代器类即可，原有类库代码无须修改，<strong>符合开闭原则</strong></li>
<li>需要<strong>更换一个迭代器</strong>，只需要增加一个新的具体迭代器类作为抽象迭代器类的子类，重新实现遍历方法即可，原有迭代器代码无须修改，也<strong>符合开闭原则</strong></li>
<li>如果<strong>要在迭代器中增加新的方法，则需要修改抽象迭代器的源代码，这将违背开闭原则</strong></li>
</ul>
</li>
</ul>
<ul>
<li>宽接口VS. 窄接口<ul>
<li>宽接口：一个聚集的接口提供了可以用来修改聚集元素的方法</li>
<li>窄接口：一个聚集的接口没有提供修改聚集元素的方法</li>
</ul>
</li>
</ul>
<ul>
<li>白箱聚集：聚集对象为所有对象提供同一个接口(宽接口)<ul>
<li>迭代子可以从外部控制聚集元素的迭代，控制的仅仅是一个游标—游标(Cursor)/外禀(Extrinsic)迭代子<br><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613205731206.png" alt="image-20220613205731206"></li>
</ul>
</li>
<li>黑箱聚集：聚集对象为迭代子对象提供一个宽接口，而为其它对象提供一个窄接口。同时保证聚集对象的封装和迭代子功能的实现<ul>
<li>迭代子是聚集的内部类，可以自由访问聚集的元素。迭代子可以自行实现迭代功能并控制聚集元素的迭代逻辑—内禀迭代子(Intrinsic Iterator)</li>
</ul>
</li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613210157224.png" alt="image-20220613210157224"></p>
<p><strong>黑盒聚集代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteAggregate</span> <span class="keyword">extends</span> <span class="title">Aggregate</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> Object[] objs = &#123; <span class="string">&quot;Monk Tang&quot;</span>, <span class="string">&quot;Monkey&quot;</span>, <span class="string">&quot;Pigsy&quot;</span>, <span class="string">&quot;Sandy&quot;</span>, <span class="string">&quot;Horse&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Iterator <span class="title">createIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ConcreteIterator();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 内部成员类：具体迭代子类</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span> </span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">int</span> currentIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">first</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			currentIndex = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">if</span> (currentIndex &lt; objs.length) &#123;</span><br><span class="line">				currentIndex++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isDone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> (currentIndex == objs.length);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> Object <span class="title">currentItem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> objs[currentIndex];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>拥有一个私有的迭代子内部类</p>
</blockquote>
<p><strong>白盒聚集代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteAggregate</span> <span class="keyword">extends</span> <span class="title">Aggregate</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Object[] objs = &#123;<span class="string">&quot;Monk Tang&quot;</span>, <span class="string">&quot;Monkey&quot;</span>,<span class="string">&quot;Pigsy&quot;</span>,<span class="string">&quot;Sandy&quot;</span>,<span class="string">&quot;Horse&quot;</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Iterator <span class="title">createIterator</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ConcreteIterator(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">getElement</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(index&lt;objs.length)&#123;</span><br><span class="line">			<span class="keyword">return</span> objs[index];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> objs.length;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>拥有一个开放的具体迭代子类且开放的聚集类</p>
</blockquote>
<h3 id="模式优点-3"><a href="#模式优点-3" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li>支持<strong>以不同的方式遍历一个聚合对象</strong>，在同一个聚合对象上<strong>可以定义多种遍历方式</strong></li>
<li><strong>简化了聚合类</strong></li>
<li>由于引入了抽象层，<strong>增加新的聚合类和迭代器类都很方便</strong>，无须修改原有代码，<strong>符合开闭原则</strong></li>
</ul>
<h3 id="模式缺点-3"><a href="#模式缺点-3" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li>在增加新的聚合类时需要对应地增加新的迭代器类，<strong>类的个数成对增加</strong>，这在一定程度上<strong>增加了系统的复杂性</strong></li>
<li><strong>抽象迭代器的设计难度较大，需要充分考虑到系统将来的扩展</strong>。在自定义迭代器时，<strong>创建一个考虑全面的抽象迭代器并不是一件很容易的事情</strong></li>
</ul>
<h3 id="模式适用环境-3"><a href="#模式适用环境-3" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>访问一个聚合对象的内容而<strong>无须暴露它的内部表示</strong></li>
<li>需要<strong>为一个聚合对象提供多种遍历方式</strong></li>
<li><strong>为遍历不同的聚合结构提供一个统一的接口</strong>，在该接口的实现类中为不同的聚合结构提供不同的遍历方式，而<strong>客户端可以一致性地操作该接口</strong></li>
</ul>
<h2 id="Mediator-Pattern-中介者模式"><a href="#Mediator-Pattern-中介者模式" class="headerlink" title="Mediator Pattern 中介者模式"></a>Mediator Pattern 中介者模式</h2><p>分析：</p>
<ul>
<li>星型结构：中介者模式将系统的网状结构变成以终结者为中心的星型结构，同事对象不再直接与另一个对象联系，他通过中介者对象与另一个对象发生相互作用。系统的结构不会因为新对象的引入带来大量的修改工作。</li>
</ul>
<img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613212522045.png" alt="image-20220613212522045" style="zoom:67%;" />

<p>中介者模式：<strong>定义一个对象来封装一系列对象的交互</strong>。中介者模式使各对象之间不需要显式地相互引用，从而使其<strong>耦合松散</strong>，而且让你<strong>可以独立地改变它们之间的交互。</strong></p>
<ul>
<li>又称为<strong>调停者模式</strong></li>
<li>在中介者模式中，通过<strong>引入中介者来简化对象之间的复杂交互</strong></li>
<li>中介者模式是<strong>迪米特法则</strong>的一个典型应用</li>
<li>对象之间<strong>多对多</strong>的复杂关系转化为相对简单的<strong>一对多</strong>关系</li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613212842820.png" alt="image-20220613212842820"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> ArrayList&lt;Colleague&gt; colleagues = <span class="keyword">new</span></span><br><span class="line">        ArrayList&lt;Colleague&gt;(); <span class="comment">//用于存储同事对象</span></span><br><span class="line">    <span class="comment">//注册方法，用于增加同事对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(Colleague colleague)</span> </span>&#123;</span><br><span class="line">        colleagues.add(colleague);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//声明抽象的业务方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteMediator</span> <span class="keyword">extends</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="comment">//实现业务方法，封装同事之间的调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ......</span><br><span class="line">            ((Colleague)(colleagues.get(<span class="number">0</span>))).method1(); <span class="comment">//通过中介者调用同事</span></span><br><span class="line">        类的方法</span><br><span class="line">            ......</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Mediator mediator; <span class="comment">//维持一个抽象中介者的引用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Colleague</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mediator=mediator;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>; <span class="comment">//声明自身方法，处理自己的行为</span></span><br><span class="line">    <span class="comment">//定义依赖方法，与中介者进行通信</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mediator.operation();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteColleague</span> <span class="keyword">extends</span> <span class="title">Colleague</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteColleague</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(mediator);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//实现自身方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ......</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="模式优点-4"><a href="#模式优点-4" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li><strong>简化了对象之间的交互</strong>，它用中介者和同事的<strong>一对多</strong>交互代替了原来同事之间的<strong>多对多</strong>交互，将原本难以理解的<strong>网状结构</strong>转换成相对简单的<strong>星型结构</strong></li>
<li><strong>可将各同事对象解耦</strong></li>
<li><strong>可以减少子类生成</strong>，中介者模式将原本分布于多个对象间的行为集中在一起，改变这些行为只需生成新的中介者子类即可，这使得各个同事类可被重用，无须直接对同事类进行扩展</li>
</ul>
<h3 id="模式缺点-4"><a href="#模式缺点-4" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li><strong>在具体中介者类中包含了大量的同事之间的交互细节</strong>，可能会导致<strong>具体中介者类非常复杂</strong>，使得系统难以维护</li>
</ul>
<h3 id="模式适用环境-4"><a href="#模式适用环境-4" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>系统中<strong>对象之间存在复杂的引用关系</strong>，系统结构混乱且难以理解</li>
<li>一个对象由于引用了其他很多对象并且直接和这些对象通信，导致<strong>难以复用</strong>该<strong>对象</strong></li>
<li>想通过一个<strong>中间类</strong>来<strong>封装多个类中的行为</strong>，又<strong>不想生成太多的子类</strong></li>
</ul>
<h2 id="Memento-Pattern-备忘录模式"><a href="#Memento-Pattern-备忘录模式" class="headerlink" title="Memento Pattern 备忘录模式"></a>Memento Pattern 备忘录模式</h2><ul>
<li>分析<ul>
<li>通过使用备忘录模式可以<strong>让系统恢复到某一特定的历史状态</strong></li>
<li>首先<strong>保存软件系统的历史状态</strong>，当用户需要取消错误操作并且返回到某个历史状态时，可以<strong>取出事先保存的历史状态来覆盖当前状态</strong></li>
</ul>
</li>
</ul>
<p>备忘录模式：<strong>在不破坏封装的前提下</strong>，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样就<strong>可以在以后将对象恢复到原先保存的状态。</strong></p>
<ul>
<li><p>备忘录模式的定义</p>
<ul>
<li>别名为**标记(Token)**模式</li>
<li>提供了一种<strong>状态恢复</strong>的实现机制，使得用户可以方便地<strong>回到一个特定的历史步骤</strong></li>
<li>当前在很多软件所提供的**撤销(Undo)**操作中就使用了备忘录模式</li>
</ul>
</li>
<li><p>备忘录模式的结构</p>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220613213646901.png" alt="image-20220613213646901"></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Originator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String state;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Originator</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="comment">//创建一个备忘录对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">createMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Memento(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据备忘录对象恢复原发器状态</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restoreMemento</span><span class="params">(Memento m)</span> </span>&#123;</span><br><span class="line">        state = m.state;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state=state;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//备忘录类，默认可见性，包内可见</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String state;</span><br><span class="line">    Memento(Originator o) &#123;</span><br><span class="line">        state = o.getState();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state=state;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Memento memento;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memento;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memento=memento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>备忘录模式的实现<ul>
<li>除了Originator类，<strong>不允许其他类来调用备忘录类Memento的构造函数与相关方法</strong></li>
<li><strong>如果允许其他类调用setState()等方法，将导致在备忘录中保存的历史状态发生改变，通过撤销操作所恢复的状态就不再是真实的历史状态</strong>，备忘录模式也就失去了本身的意义</li>
<li>理想的情况是<strong>只允许生成该备忘录的原发器访问备忘录的内部状态</strong></li>
</ul>
</li>
</ul>
<h3 id="模式优点-5"><a href="#模式优点-5" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li><strong>提供了一种状态恢复的实现机制</strong>，使得用户可以方便地回到一个特定的历史步骤</li>
<li><strong>实现了对信息的封装</strong>，一个备忘录对象是一种原发器对象状态的表示，不会被其他代码所改动</li>
</ul>
<h3 id="模式缺点-5"><a href="#模式缺点-5" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li><strong>资源消耗过大</strong>，如果需要保存的原发器类的成员变量太多，就不可避免地需要占用大量的存储空间，<strong>每保存一次对象的状态都需要消耗一定的系统资源</strong></li>
</ul>
<h3 id="模式适用环境-5"><a href="#模式适用环境-5" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li><strong>保存一个对象在某一个时刻的全部状态或部分状态</strong>，这样以后<strong>需要时能够恢复到先前的状态，实现撤销操作</strong></li>
<li><strong>防止外界对象破坏一个对象历史状态的封装性</strong>，避免将对象历史状态的实现细节暴露给外界对象</li>
</ul>
<h2 id="Observer-Pattern-观察者模式"><a href="#Observer-Pattern-观察者模式" class="headerlink" title="Observer Pattern 观察者模式"></a><font color = red>Observer Pattern 观察者模式</font></h2><ul>
<li>分析<ul>
<li>软件系统：<strong>一个对象的状态或行为的变化将导致其他对象的状态或行为也发生改变</strong>，它们之间将<strong>产生联动</strong></li>
<li>观察者模式：<ul>
<li>定义了对象之间一种<strong>一对多</strong>的依赖关系，让一个对象的改变能够影响其他对象</li>
<li>发生改变的对象称为<strong>观察目标</strong>，被通知的对象称为<strong>观察者</strong></li>
<li><strong>一个观察目标</strong>可以对应多个<strong>观察者</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>观察者模式：定义对象之间的一种<strong>一对多依赖关系</strong>，使得每<strong>当一个对象状态发生改变时</strong>，其相关依赖对象<strong>都得到通知并被自动更新</strong>。</p>
<ul>
<li>别名<ul>
<li>发布-订阅（Publish/Subscribe）模式</li>
<li>模型-视图（Model/View）模式</li>
<li>源-监听器（Source/Listener）模式</li>
<li>从属者模式（Dependents）模式</li>
</ul>
</li>
</ul>
<img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220614163438041.png" alt="image-20220614163438041" style="zoom: 67%;" />

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义一个观察者集合用于存储所有观察者对象</span></span><br><span class="line">    <span class="keyword">protected</span> ArrayList observers&lt;Observer&gt; = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    <span class="comment">//注册方法，用于向观察者集合中增加一个观察者</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observers.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//注销方法，用于在观察者集合中删除一个观察者</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observers.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//声明抽象通知方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteSubject</span> <span class="keyword">extends</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="comment">//实现通知方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//遍历观察者集合，调用每一个观察者的响应方法</span></span><br><span class="line">        <span class="keyword">for</span>(Object obs:observers) &#123;</span><br><span class="line">            ((Observer)obs).update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//声明响应方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//实现响应方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//具体响应代码</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="观察者与MVC"><a href="#观察者与MVC" class="headerlink" title="观察者与MVC"></a>观察者与MVC</h3><ul>
<li><strong>MVC(Model-View-Controller)架构</strong><ul>
<li><strong>模型(Model)，视图(View)和控制器(Controller)</strong></li>
<li><strong>模型</strong>可对应于观察者模式中的<strong>观察目标，</strong>而<strong>视图对应于观察者</strong>，<strong>控制器可充当两者之间的中介者</strong></li>
<li>当模型层的数据发生改变时，视图层将自动改变其显示内容</li>
</ul>
</li>
</ul>
<h3 id="模式优点-6"><a href="#模式优点-6" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li>可以实现<strong>表示层和数据逻辑层的分离</strong></li>
<li>在观察目标和观察者之间<strong>建立一个抽象的耦合</strong></li>
<li>支持<strong>广播通信，简化了一对多系统设计的难度</strong></li>
<li><strong>符合开闭原则</strong>，增加新的具体观察者无须修改原有系统代码，在具体观察者与观察目标之间不存在关联关系的情况下，增加新的观察目标也很方便</li>
</ul>
<h3 id="模式缺点-6"><a href="#模式缺点-6" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li>将所有的观察者都通知到会<strong>花费很多时间</strong></li>
<li>如果存在<strong>循环依赖</strong>时可能<strong>导致系统崩溃</strong></li>
<li><strong>没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的</strong>，而只是知道观察目标发生了变化</li>
</ul>
<h3 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h3><ul>
<li>一个抽象模型有两个方面，其中<strong>一个方面依赖于另一个方面</strong>，将这两个方面封装在独立的对象中使它们<strong>可以各自独立地改变和复用</strong></li>
<li><strong>一个对象的改变将导致一个或多个其他对象发生改变</strong>，且<strong>并不知道具体有多少对象将发生改变，也不知道这些对象是谁</strong></li>
<li>需要在系统中创建一个<strong>触发链</strong></li>
</ul>
<h2 id="State-Pattern-状态模式"><a href="#State-Pattern-状态模式" class="headerlink" title="State Pattern 状态模式"></a>State Pattern 状态模式</h2><p>状态模式：允许一个对象在其<strong>内部状态改变时改变他的行为。对象看起来似乎修改了它的类。</strong></p>
<ul>
<li>状态模式的定义<ul>
<li>又名<strong>状态对象(Objects for States)</strong></li>
<li>用于解决系统中<strong>复杂对象的状态转换以及不同状态下行为的封装问题</strong></li>
<li>将一个对象的状态从该对象中<strong>分离出来</strong>，<strong>封装到专门的状态类中，使得对象状态可以灵活变化</strong></li>
<li>对于<strong>客户端</strong>而言，<strong>无须关心对象状态的转换以及对象所处的当前状态</strong>，无论对于何种状态的对象，客户端都可以一致处理</li>
</ul>
</li>
</ul>
<ul>
<li><p>状态模式的定义</p>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220614164555989.png" alt="image-20220614164555989"></p>
</li>
</ul>
<blockquote>
<p>状态模式包含以下3个角色：<br>• Context（环境类）<br>• State（抽象状态类）<br>• ConcreteState（具体状态类）</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    <span class="comment">//声明抽象业务方法，不同的具体状态类可以有不同的实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteState</span> <span class="keyword">extends</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//方法具体实现代码</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> State state; <span class="comment">//维持一个对抽象状态对象的引用</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value; <span class="comment">//其他属性值，该属性值的变化可能会导致对象的</span></span><br><span class="line">    状态发生变化</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(State state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//其他代码</span></span><br><span class="line">        state.handle(); <span class="comment">//调用状态对象的业务方法</span></span><br><span class="line">        <span class="comment">//其他代码</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 转换状态的实现</span></span><br><span class="line">……</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changeState</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//判断属性值，根据属性值进行状态转换</span></span><br><span class="line"><span class="keyword">if</span> (value == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.setState(<span class="keyword">new</span> ConcreteStateA());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (value == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.setState(<span class="keyword">new</span> ConcreteStateB());</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line">&#125;</span><br><span class="line">……</span><br><span class="line"><span class="comment">// 通过切换不同的实例来做到状态的转换</span></span><br></pre></td></tr></table></figure>



<h3 id="模式优点-7"><a href="#模式优点-7" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li><strong>封装了状态的转换规则</strong>，可以对状态转换代码进行<strong>集中管理</strong>，而不是分散在一个个业务方法中</li>
<li><strong>将所有与某个状态有关的行为放到一个类中</strong>，只需要注入一个不同的状态对象即可使环境对象拥有不同的行为</li>
<li><strong>允许状态转换逻辑与状态对象合成一体，而不是提供一个巨大的条件语句块</strong>，可以避免使用庞大的条件语句来将业务方法和状态转换代码交织在一起</li>
<li>可以让多个环境对象<strong>共享一个状态对象</strong>，从而<strong>减少系统中对象的个数</strong></li>
</ul>
<h3 id="模式缺点-7"><a href="#模式缺点-7" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li>会<strong>增加系统中类和对象的个数，导致系统运行开销增大</strong></li>
<li>结构与实现都较为复杂，如果<strong>使用不当将导致程序结构和代码混乱，增加系统设计的难度</strong></li>
<li><strong>对开闭原则的支持并不太好</strong>，增加新的状态类需要修改负责状态转换的源代码，否则无法转换到新增状态；而且修改某个状态类的行为也需要修改对应类的源代码</li>
</ul>
<h3 id="模式适用环境-6"><a href="#模式适用环境-6" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>对象的<strong>行为依赖于</strong>它的<strong>状态</strong>（例如某些属性值），<strong>状态的改变将导致行为的变化</strong></li>
<li><strong>在代码中包含大量与对象状态有关的条件语句</strong>，这些条件语句的出现会导致代码的可维护性和灵活性变差，不能方便地增加和删除状态，并且导致客户类与类库之间的耦合增强</li>
</ul>
<h2 id="Strategy-Pattern-策略模式"><a href="#Strategy-Pattern-策略模式" class="headerlink" title="Strategy Pattern 策略模式"></a>Strategy Pattern 策略模式</h2><p>策略模式：定义<strong>一系列算法，将每一个算法封装起来</strong>，并让它们可以相互替换。策略模式让算法可以独立于使用它的客户变化。</p>
<ul>
<li><p>策略模式的定义</p>
<ul>
<li>又称为<strong>政策(Policy)模式</strong></li>
<li>每一个封装算法的类称之为**策略(Strategy)**类</li>
<li>策略模式提供了一种<strong>可插入式(Pluggable)算法</strong>的实现方案</li>
</ul>
</li>
<li><p>策略模式的结构</p>
</li>
</ul>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220614170230029.png" alt="image-20220614170230029"></p>
<blockquote>
<p>• Context（环境类）<br>• Strategy（抽象策略类）<br>• ConcreteStrategy（具体策略类）</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">algorithm</span><span class="params">()</span></span>; <span class="comment">//声明抽象算法</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteStrategyA</span> <span class="keyword">extends</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="comment">//算法的具体实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">algorithm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//算法A</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Strategy strategy; <span class="comment">//维持一个对抽象策略类的引用</span></span><br><span class="line">    <span class="comment">//注入策略对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStrategy</span><span class="params">(Strategy strategy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy= strategy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//调用策略类中的算法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">algorithm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        strategy.algorithm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">……</span><br><span class="line">Context context = <span class="keyword">new</span> Context();</span><br><span class="line">Strategy strategy;</span><br><span class="line">strategy = <span class="keyword">new</span> ConcreteStrategyA(); <span class="comment">//可在运行时指定类型，通过配置</span></span><br><span class="line">文件和反射机制实现</span><br><span class="line">context.setStrategy(strategy);</span><br><span class="line">context.algorithm();</span><br><span class="line">……</span><br></pre></td></tr></table></figure>



<h3 id="模式优点-8"><a href="#模式优点-8" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li>提供了<strong>对开闭原则的完美支持</strong>，用户可以在不修改原有系统的基础上选择算法或行为，也可以灵活地增加新的算法或行为</li>
<li>提供了<strong>管理相关的算法族的办法</strong></li>
<li>提供了一种<strong>可以替换继承关系的办法</strong></li>
<li>可以<strong>避免多重条件选择语句</strong></li>
<li>提供了一种<strong>算法的复用机制</strong>，不同的环境类可以方便地复用策略类</li>
</ul>
<h3 id="模式缺点-8"><a href="#模式缺点-8" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li>客户端<strong>必须知道所有的策略类</strong>，并自行决定使用哪一个策略类</li>
<li>将造成系统<strong>产生很多具体策略类</strong></li>
<li><strong>无法同时在客户端使用多个策略类</strong></li>
</ul>
<h3 id="模式适用环境-7"><a href="#模式适用环境-7" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>一个系统需要<strong>动态地在几种算法中选择一种</strong></li>
<li><strong>避免使用难以维护的多重条件选择语句</strong></li>
<li>不希望客户端知道复杂的、与算法相关的数据结构，<strong>提高算法的保密性与安全性</strong></li>
</ul>
<h2 id="Template-Method-Pattern-模板方法模式"><a href="#Template-Method-Pattern-模板方法模式" class="headerlink" title="Template Method Pattern 模板方法模式"></a><font color = red>Template Method Pattern 模板方法模式</font></h2><p><strong>模板方法模式</strong>：定义一个操作中<strong>算法的框架</strong>，而<strong>将一些步骤延迟到子类中</strong>。不满方法模式是的子类不改变一个算法结构即可<strong>重定义</strong>该算法的<strong>某些特定步骤</strong>。</p>
<ul>
<li><p>模板方法模式的定义</p>
<ul>
<li>是一种<strong>基于继承的代码复用技术</strong></li>
<li>将一些复杂流程的<strong>实现步骤</strong>封装在一系列<strong>基本方法</strong>中</li>
<li>在抽象父类中提供一个称之为<strong>模板方法</strong>的方法来<strong>定义这些基本方法的执行次序</strong>，而通过其子类来覆盖某些步骤，从而使得<strong>相同的算法框架</strong>可以<strong>有不同的执行结果</strong></li>
</ul>
</li>
<li><p>模板方法模式的结构</p>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220614184242143.png" alt="image-20220614184242143"></p>
<blockquote>
<p>实现代码来自<a target="_blank" rel="noopener" href="http://c.biancheng.net/view/1376.html">模板方法模式（模板方法设计模式）详解 (biancheng.net)</a></p>
</blockquote>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HookTemplateMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        HookAbstractClass tm = <span class="keyword">new</span> HookConcreteClass();</span><br><span class="line">        tm.TemplateMethod();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//含钩子方法的抽象类</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HookAbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">//模板方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TemplateMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        abstractMethod1();</span><br><span class="line">        HookMethod1();</span><br><span class="line">        <span class="keyword">if</span> (HookMethod2()) &#123;</span><br><span class="line">            SpecificMethod();</span><br><span class="line">        &#125;</span><br><span class="line">        abstractMethod2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//具体方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SpecificMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;抽象类中的具体方法被调用...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//钩子方法1</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HookMethod1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//钩子方法2</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">HookMethod2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//抽象方法1</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">abstractMethod1</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//抽象方法2</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">abstractMethod2</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//含钩子方法的具体子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HookConcreteClass</span> <span class="keyword">extends</span> <span class="title">HookAbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractMethod1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;抽象方法1的实现被调用...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">abstractMethod2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;抽象方法2的实现被调用...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HookMethod1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;钩子方法1被重写...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">HookMethod2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>通过使用钩子方法使得子类控制父类的行为。（控制调用那个抽象方法的实现）</p>
</blockquote>
<h3 id="模式优点-9"><a href="#模式优点-9" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li>在父类中形式化地定义一个算法，而由它的子类来实现细节的处理，<strong>在子类实现详细的处理算法时并不会改变算法中步骤的执行次序</strong></li>
<li>提取了类库中的公共行为，<strong>将公共行为放在父类中</strong>，而通过其子类来实现不同的行为</li>
<li><strong>可实现一种反向控制结构</strong>，通过子类覆盖父类的钩子方法来决定某一特定步骤是否需要执行</li>
<li>更换和增加新的子类很方便，<strong>符合单一职责原则和开闭原则</strong></li>
</ul>
<h3 id="模式缺点-9"><a href="#模式缺点-9" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li>需要为每一个基本方法的不同实现提供一个子类，<strong>如果父类中可变的基本方法太多，将会导致类的个数增加</strong>，系统会更加庞大，设计也更加抽象（可结合桥接模式）</li>
</ul>
<h3 id="模式适用环境-8"><a href="#模式适用环境-8" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li><strong>一次性实现一个算法的不变部分</strong>，并将<strong>可变的行为留给子类来实现</strong></li>
<li>各子类中<strong>公共的行为</strong>应被提取出来，并集中到一个<strong>公共父类</strong>中，以<strong>避免代码重复</strong></li>
<li>需要<strong>通过子类来决定父类算法中某个步骤是否执行</strong>，实现<strong>子类对父类的反向控制</strong></li>
</ul>
<h2 id="Visitor-Pattern-访问者模式"><a href="#Visitor-Pattern-访问者模式" class="headerlink" title="Visitor Pattern 访问者模式"></a><font color=red>Visitor Pattern 访问者模式</font></h2><ul>
<li>分析<ul>
<li>对象结构中存储了<strong>多种不同类型</strong>的对象信息</li>
<li>对同一对象结构中的元素的<strong>操作方式并不唯一</strong>，可能需要<strong>提供多种不同的处理方式</strong></li>
<li>还有可能需要<strong>增加新的处理方式</strong></li>
</ul>
</li>
</ul>
<p>访问者模式：表示一个作用于某<strong>对象结构</strong>中的各个元素的操作。访问者模式让你<strong>可以在不改变各元素的类的前提下定义作用于这些元素的新操作。</strong></p>
<ul>
<li><p>访问者模式的定义</p>
<ul>
<li><p>它为<strong>操作存储不同类型元素的对象结构</strong>提供了一种解决方案</p>
</li>
<li><p>用户<strong>可以对不同类型的元素施加不同的操作</strong></p>
</li>
</ul>
</li>
<li><p>访问者模式的结构</p>
<p><img src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220614190046821.png" alt="image-20220614190046821"></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VisitorPattern</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ObjectStructure os = <span class="keyword">new</span> ObjectStructure();</span><br><span class="line">        os.add(<span class="keyword">new</span> ConcreteElementA());</span><br><span class="line">        os.add(<span class="keyword">new</span> ConcreteElementB());</span><br><span class="line">        Visitor visitor = <span class="keyword">new</span> ConcreteVisitorA();</span><br><span class="line">        os.accept(visitor);</span><br><span class="line">        System.out.println(<span class="string">&quot;------------------------&quot;</span>);</span><br><span class="line">        visitor = <span class="keyword">new</span> ConcreteVisitorB();</span><br><span class="line">        os.accept(visitor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//抽象访问者</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElementA element)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElementB element)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体访问者A类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteVisitorA</span> <span class="keyword">implements</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElementA element)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体访问者A访问--&gt;&quot;</span> + element.operationA());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElementB element)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体访问者A访问--&gt;&quot;</span> + element.operationB());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体访问者B类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteVisitorB</span> <span class="keyword">implements</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElementA element)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体访问者B访问--&gt;&quot;</span> + element.operationA());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElementB element)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;具体访问者B访问--&gt;&quot;</span> + element.operationB());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//抽象元素类</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体元素A类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteElementA</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">operationA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;具体元素A的操作。&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体元素B类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteElementB</span> <span class="keyword">implements</span> <span class="title">Element</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">operationB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;具体元素B的操作。&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对象结构角色</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ObjectStructure</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Element&gt; list = <span class="keyword">new</span> ArrayList&lt;Element&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">        Iterator&lt;Element&gt; i = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (i.hasNext()) &#123;</span><br><span class="line">            ((Element) i.next()).accept(visitor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Element element)</span> </span>&#123;</span><br><span class="line">        list.add(element);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Element element)</span> </span>&#123;</span><br><span class="line">        list.remove(element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>通过遍历一种结构来获取应该调用的访问对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * accept抽象接收方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> visitor</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NodeA</span> <span class="keyword">extends</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">		visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * NodeA特有的商业方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">operationA</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;NodeA is visited&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NodeB</span> <span class="keyword">extends</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor visitor)</span> </span>&#123;</span><br><span class="line">		visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * NodeB特有的商业方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">operationB</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;NodeB is visited&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 对应于NodeA的访问操作</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(NodeA node)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 对应于NodeB的访问操作</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(NodeB node)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VisitorA</span> <span class="keyword">implements</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(NodeA node)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;VisitorA: &quot;</span>+node.operationA());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(NodeB node)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;VisitorA: &quot;</span>+node.operationB());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VisitorB</span> <span class="keyword">implements</span> <span class="title">Visitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(NodeA node)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;VisitorB: &quot;</span>+node.operationA());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(NodeB node)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;VisitorB: &quot;</span>+node.operationB());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectStructure</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Vector&lt;Node&gt; nodes;</span><br><span class="line">	<span class="keyword">private</span> Node node;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ObjectStructure</span><span class="params">()</span></span>&#123;</span><br><span class="line">		nodes = <span class="keyword">new</span> Vector&lt;Node&gt;();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 执行访问操作</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> visitor</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">action</span><span class="params">(Visitor visitor)</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(Enumeration&lt;Node&gt; e = nodes.elements(); e.hasMoreElements();)&#123;</span><br><span class="line">			node = (Node)e.nextElement();</span><br><span class="line">			node.accept(visitor);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 增加一个新元素</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Node node)</span></span>&#123;</span><br><span class="line">		nodes.addElement(node);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VisitorClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//创建一个结构对象</span></span><br><span class="line">		ObjectStructure aObjects = <span class="keyword">new</span> ObjectStructure();</span><br><span class="line">		<span class="comment">//增加节点</span></span><br><span class="line">		aObjects.add(<span class="keyword">new</span> NodeA());</span><br><span class="line">		aObjects.add(<span class="keyword">new</span> NodeB());</span><br><span class="line">		aObjects.add(<span class="keyword">new</span> NodeA());</span><br><span class="line">		<span class="comment">//创建一个访问者</span></span><br><span class="line">		Visitor visitor1 = <span class="keyword">new</span> VisitorA();</span><br><span class="line">		<span class="comment">//让访问者访问结构</span></span><br><span class="line">		aObjects.action(visitor1);</span><br><span class="line">		<span class="comment">//创建一个新的访问者</span></span><br><span class="line">		Visitor visitor2 = <span class="keyword">new</span> VisitorB();</span><br><span class="line">		<span class="comment">//让新的访问者访问结构</span></span><br><span class="line">		aObjects.action(visitor2);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="分派"><a href="#分派" class="headerlink" title="分派"></a>分派</h3><blockquote>
<p>以下内容来自<a target="_blank" rel="noopener" href="https://www.cnblogs.com/jiaoyiping/p/9769554.html">访问者模式和双分派 - 梦中彩虹 - 博客园 (cnblogs.com)</a></p>
</blockquote>
<blockquote>
<p>访问者模式是一种伪动态双分派</p>
</blockquote>
<p>变量被声明时的类型叫做变量的静态类型(Static Type) 又叫明显类型(Apparent Type)。变量所引用的对象的真实类型又叫做变量的实际类型(Actual Type)。<br>**根据对象的类型而对方法进行的选择,就是分派(Dispatch)**。</p>
<p>根据分派发生的时期，可以将分派分为两种，即<strong>静态分派和动态分派。</strong></p>
<h4 id="静态分派和动态分派"><a href="#静态分派和动态分派" class="headerlink" title="静态分派和动态分派"></a>静态分派和动态分派</h4><p><strong>静态分派(Static Dispatch)</strong> 发生在编译时期，分派根据静态类型信息发生。<strong>方法重载(Overload)<strong>就是静态分派的最典型的应用。</strong>（所谓的：编译时多态）</strong></p>
<p><strong>动态分派(Dynamic Dispatch)</strong> 发生在运行时期，动态分派动态地置换掉某个方法。面向对象的语言利用动态分派来实现方法置换产生的多态性。<strong>（所谓的：运行时多态）</strong></p>
<p>也就是,运行的时候,<strong>根据参数的类型,选择合适的重载方法,就是动态分派</strong>。</p>
<h3 id="模式优点-10"><a href="#模式优点-10" class="headerlink" title="模式优点"></a>模式优点</h3><ul>
<li><strong>增加新的访问操作很方便</strong></li>
<li>将有关元素对象的访问行为集中到一个访问者对象中，而不是分散在一个个的元素类中，<strong>类的职责更加清晰</strong></li>
<li>让用户能够在<strong>不修改现有元素类层次结构的情况下，定义作用于该层次结构的操作</strong></li>
</ul>
<h3 id="模式缺点-10"><a href="#模式缺点-10" class="headerlink" title="模式缺点"></a>模式缺点</h3><ul>
<li><strong>增加新的元素类很困难</strong></li>
<li><strong>破坏了对象的封装性</strong></li>
</ul>
<h3 id="模式适用环境-9"><a href="#模式适用环境-9" class="headerlink" title="模式适用环境"></a>模式适用环境</h3><ul>
<li>一个对象结构包含多个类型的对象，<strong>希望对这些对象实施一些依赖其具体类型的操作</strong></li>
<li>需要<strong>对一个对象结构中的对象进行很多不同的且不相关的操作</strong>，并需要<strong>避免</strong>让这些操作<strong>“污染”</strong>这些对象的类，也不希望在增加新操作时修改这些类</li>
<li><strong>对象结构中对象对应的类很少改变</strong>，但经常需要在此对象结构上定义新的操作</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://www.littleblack.cc">Little-Bla-ck</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.littleblack.cc/2022/06/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/">http://www.littleblack.cc/2022/06/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.littleblack.cc" target="_blank">软件工程专业技术分享</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></div><div class="post_share"><div class="social-share" data-image="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220612114952212.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/ShareJS/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/ShareJS/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/17/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E4%B8%8E%E8%AE%A1%E7%AE%972%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/"><img class="prev-cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/10.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">软件工程与计算II-复习提纲</div></div></a></div><div class="next-post pull-right"><a href="/2022/06/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/"><img class="next-cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220608180531603.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">设计模式-结构型模式</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/06/07/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="设计模式-创建型模式"><img class="cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220607172320786.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-07</div><div class="title">设计模式-创建型模式</div></div></a></div><div><a href="/2022/06/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="设计模式-结构型模式"><img class="cover" src="https://littleblacksimagesbed.oss-cn-hangzhou.aliyuncs.com/blogimages/image-20220608180531603.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-08</div><div class="title">设计模式-结构型模式</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/icon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Little-Bla-ck</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Little-Bla-ck/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Little-bla-ck" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1173198173@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">南京大学软件工程专业大三在读</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">设计模式-行为型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Chain-of-Responsibility-Pattern-%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">Chain of Responsibility Pattern 职责链模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9"><span class="toc-number">1.1.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83"><span class="toc-number">1.1.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Command-Pattern-%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">Command Pattern 命令模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%91%BD%E4%BB%A4%E9%98%9F%E5%88%97"><span class="toc-number">1.2.1.</span> <span class="toc-text">实现命令队列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E8%AF%B7%E6%B1%82%E6%97%A5%E5%BF%97"><span class="toc-number">1.2.2.</span> <span class="toc-text">记录请求日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%81%A2%E5%A4%8D%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.3.</span> <span class="toc-text">实现恢复操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-1"><span class="toc-number">1.2.4.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-1"><span class="toc-number">1.2.5.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-1"><span class="toc-number">1.2.6.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interpreter-Pattern-%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">Interpreter Pattern 解释器模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-2"><span class="toc-number">1.3.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Iterator-Pattern-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">Iterator Pattern 迭代器模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-3"><span class="toc-number">1.4.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mediator-Pattern-%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">Mediator Pattern 中介者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-4"><span class="toc-number">1.5.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Memento-Pattern-%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.6.</span> <span class="toc-text">Memento Pattern 备忘录模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-5"><span class="toc-number">1.6.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-5"><span class="toc-number">1.6.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-5"><span class="toc-number">1.6.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Observer-Pattern-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.7.</span> <span class="toc-text">Observer Pattern 观察者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E4%B8%8EMVC"><span class="toc-number">1.7.1.</span> <span class="toc-text">观察者与MVC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-6"><span class="toc-number">1.7.2.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-6"><span class="toc-number">1.7.3.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83"><span class="toc-number">1.7.4.</span> <span class="toc-text">适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#State-Pattern-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.8.</span> <span class="toc-text">State Pattern 状态模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-7"><span class="toc-number">1.8.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-7"><span class="toc-number">1.8.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-6"><span class="toc-number">1.8.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Strategy-Pattern-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.9.</span> <span class="toc-text">Strategy Pattern 策略模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-8"><span class="toc-number">1.9.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-8"><span class="toc-number">1.9.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-7"><span class="toc-number">1.9.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Template-Method-Pattern-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.10.</span> <span class="toc-text">Template Method Pattern 模板方法模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-9"><span class="toc-number">1.10.1.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-9"><span class="toc-number">1.10.2.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-8"><span class="toc-number">1.10.3.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Visitor-Pattern-%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.11.</span> <span class="toc-text">Visitor Pattern 访问者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%B4%BE"><span class="toc-number">1.11.1.</span> <span class="toc-text">分派</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%B4%BE%E5%92%8C%E5%8A%A8%E6%80%81%E5%88%86%E6%B4%BE"><span class="toc-number">1.11.1.1.</span> <span class="toc-text">静态分派和动态分派</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E4%BC%98%E7%82%B9-10"><span class="toc-number">1.11.2.</span> <span class="toc-text">模式优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BC%BA%E7%82%B9-10"><span class="toc-number">1.11.3.</span> <span class="toc-text">模式缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83-9"><span class="toc-number">1.11.4.</span> <span class="toc-text">模式适用环境</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/11/%E9%9D%A2%E7%BB%8F/%E9%9D%A2%E7%BB%8F%EF%BC%883%EF%BC%89%E2%80%94%E2%80%94%E9%98%BF%E9%87%8C%E9%92%89%E9%92%89%E4%B8%80%E9%9D%A2/" title="面经（3）————阿里钉钉一面"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="面经（3）————阿里钉钉一面"/></a><div class="content"><a class="title" href="/2023/03/11/%E9%9D%A2%E7%BB%8F/%E9%9D%A2%E7%BB%8F%EF%BC%883%EF%BC%89%E2%80%94%E2%80%94%E9%98%BF%E9%87%8C%E9%92%89%E9%92%89%E4%B8%80%E9%9D%A2/" title="面经（3）————阿里钉钉一面">面经（3）————阿里钉钉一面</a><time datetime="2023-03-11T12:56:31.000Z" title="发表于 2023-03-11 20:56:31">2023-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/17/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E9%9C%80%E6%B1%82/" title="需求与商业模式——需求工程"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——需求工程"/></a><div class="content"><a class="title" href="/2023/02/17/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E9%9C%80%E6%B1%82/" title="需求与商业模式——需求工程">需求与商业模式——需求工程</a><time datetime="2023-02-17T09:20:17.244Z" title="发表于 2023-02-17 17:20:17">2023-02-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E7%94%BB%E5%B8%83/" title="需求与商业模式——商业模式画布"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——商业模式画布"/></a><div class="content"><a class="title" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E7%94%BB%E5%B8%83/" title="需求与商业模式——商业模式画布">需求与商业模式——商业模式画布</a><time datetime="2023-02-16T15:09:37.674Z" title="发表于 2023-02-16 23:09:37">2023-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E8%AF%84%E4%BC%B0%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——商业模式评估"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——商业模式评估"/></a><div class="content"><a class="title" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E8%AF%84%E4%BC%B0%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——商业模式评估">需求与商业模式——商业模式评估</a><time datetime="2023-02-16T15:09:37.672Z" title="发表于 2023-02-16 23:09:37">2023-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%85%B8%E5%9E%8B%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——典型商业模式"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="需求与商业模式——典型商业模式"/></a><div class="content"><a class="title" href="/2023/02/16/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E8%AE%BE%E8%AE%A1/%E5%85%B8%E5%9E%8B%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F/" title="需求与商业模式——典型商业模式">需求与商业模式——典型商业模式</a><time datetime="2023-02-16T15:09:37.669Z" title="发表于 2023-02-16 23:09:37">2023-02-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>宁ICP备2022000187号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/pluginsSrc/instant.page/instantpage.js" type="module"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = '/pluginsSrc/mathjax/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="/pluginsSrc/katex/dist/katex.min.css"><script src="/pluginsSrc/katex/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="/pluginsSrc/katex/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('/pluginsSrc/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="/pluginsSrc/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="/pluginsSrc/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>